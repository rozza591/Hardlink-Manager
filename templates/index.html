<!DOCTYPE html>
<html>

<head>
    <title>Hardlink Manager</title>
    <link rel="icon" href="/static/logos/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/style.css">
    <script src="/static/app.js" defer></script>
</head>

<body>
    <div class="dark-toggle" id="darkToggle">Dark Mode</div>

    <div class="container">
        <div class="header-container">
            <img src="/static/logos/hardlink-manager-logo-3.png" alt="Logo" class="logo">
            <h1>Hardlink Manager</h1>
        </div>

        <form id="scan-form">
            <div class="form-group">
                <label for="path1">Directory Path:</label>
                <input type="text" id="path1" name="path1" required placeholder="/data/media">
                <small>Enter the full path accessible by the server (e.g., `/data/movies`).</small>
            </div>

            <div class="form-grid">
                <!-- Row 1: Checkbox Options -->
                <div class="option-card">
                    <label class="option-label" title="Files share the same data on disk. Saves space instantly.">
                        <input type="checkbox" id="hardlink" name="hardlink" checked
                            onchange="handleLinkTypeSelection(this)">
                        Hard Links (Recommended)
                    </label>
                </div>
                <div class="option-card">
                    <label class="option-label"
                        title="Creates a symbolic reference. Good for cross-filesystem (not here).">
                        <input type="checkbox" id="softlink" name="softlink" onchange="handleLinkTypeSelection(this)">
                        Soft Links (Symbolic)
                    </label>
                </div>
                <div class="option-card">
                    <label class="option-label" title="Simulates the process without making changes.">
                        <input type="checkbox" id="dryrun" name="dryrun" checked onchange="handleDryRunSelection(this)">
                        Dry Run (No changes)
                    </label>
                </div>
                <div class="option-card">
                    <label class="option-label"
                        title="Automatically save results to a JSON file in the scan directory.">
                        <input type="checkbox" id="save_auto" name="save_auto">
                        Auto-Save Results (JSON)
                    </label>
                </div>
            </div>

            <div class="form-grid" style="margin-top: 15px;">
                <!-- Row 2: Ignore Patterns -->
                <div class="input-card">
                    <label for="ignore_dirs">Ignore Directories:</label>
                    <input type="text" id="ignore_dirs" name="ignore_dirs" placeholder="e.g. .git, tmp, node_modules">
                </div>
                <div class="input-card">
                    <label for="ignore_exts">Ignore Extensions:</label>
                    <input type="text" id="ignore_exts" name="ignore_exts" placeholder="e.g. .log, .tmp, .bak">
                </div>
            </div>

            <div class="button-group">
                <button type="submit" id="submit-btn">Start Scan</button>
                <button type="button" id="clear-cache-btn">Clear Results</button>
            </div>
        </form>

        <div id="status-message">
            <div class="progress-phases" id="progress-phases">
                <span class="progress-phase" data-phase="Finding Files">Finding</span>
                <span class="progress-phase" data-phase="Pre-Hashing">Pre-Hash</span>
                <span class="progress-phase" data-phase="Full Hashing">Hashing</span>
                <span class="progress-phase" data-phase="Analyzing Hashes">Analyzing</span>
                <span class="progress-phase" data-phase="Linking Files">Linking</span>
                <span class="progress-phase" data-phase="Complete">Done</span>
            </div>
            <div id="status-phase">Initializing...</div>
            <div id="status-details">Please wait.</div>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar-inner"></div>
            </div>
            <div id="status-stats" class="status-stats">
                <span id="status-count"></span>
                <span id="status-eta"></span>
            </div>
        </div>

        <div id="error-message"></div>

        <div id="results">
            <h2>Scan Results</h2>
            <div class="results-button-bar">
                <button type="button" id="download-json-btn" class="download-button">Download JSON</button>
            </div>
            <div id="summary-stats">
                <p><strong>Overall Status:</strong> <span id="result-action">N/A</span></p>
                <hr>
                <p><strong>Initial Size:</strong> <span id="result-before-size">N/A</span></p>
                <p><strong>Final Size (Theoretical):</strong> <span id="result-after-size">N/A</span></p>
                <p><strong>Space Saved:</strong> <span id="result-savings">N/A</span></p>
                <p><strong>Duration:</strong> <span id="result-duration">N/A</span></p>
            </div>
            <div id="link-actions">
                <p>Perform linking based on this dry run?</p>
                <button id="perform-hardlink-btn" data-link-type="hard">Perform Hard Link</button>
                <button id="perform-softlink-btn" data-link-type="soft" class="softlink">Perform Soft Link</button>
            </div>
            <div id="duplicates">
            </div>
            <div id="pagination-controls" class="pagination-controls" style="display:none;">
                <button id="prev-page-btn" class="page-btn">Previous</button>
                <span id="page-info">Page 1 of 1</span>
                <button id="next-page-btn" class="page-btn">Next</button>
                <select id="page-size-select" class="page-select">
                    <option value="10">10 per page</option>
                    <option value="25" selected>25 per page</option>
                    <option value="50">50 per page</option>
                    <option value="100">100 per page</option>
                </select>
            </div>
        </div>
    </div>
</body>

</html>