<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardlink Manager | Deduplicate & Save Space</title>
    <link rel="icon" href="/static/logos/favicon.ico" type="image/x-icon">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="/static/css/variables.css">
    <link rel="stylesheet" href="/static/css/layout.css">
    <link rel="stylesheet" href="/static/css/components.css">

    <!-- Application -->
    <script type="module" src="/static/js/main.js"></script>
</head>

<body>
    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="/static/logos/hardlink-manager-logo-3.png" alt="Logo">
                <h2>Hardlink Manager</h2>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-view="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-view="wizard">
                    <i class="fas fa-plus-circle"></i>
                    <span>New Scan</span>
                </a>
                <a href="#" class="nav-item" data-view="schedules">
                    <i class="fas fa-clock"></i>
                    <span>Schedules</span>
                </a>
                <a href="#" class="nav-item" data-view="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </nav>

            <div class="sidebar-footer" style="padding: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                <button id="theme-toggle" class="btn btn-outline"
                    style="width: 100%; color: white; border-color: rgba(255,255,255,0.2);">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">

            <!-- VIEW: DASHBOARD -->
            <section id="dashboard-view" class="view-section active">
                <header class="view-header">
                    <h1>Dashboard</h1>
                    <p>Welcome back. Here's your storage optimization summary.</p>
                </header>

                <div class="stats-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 24px; margin-bottom: 30px;">
                    <div class="card" style="margin-bottom: 0;">
                        <span
                            style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase;">Total
                            Space Saved</span>
                        <h3 id="total-saved-stat" style="font-size: 2rem; margin: 10px 0 0 0; color: var(--success);">0
                            <span>Bytes</span>
                        </h3>
                    </div>
                    <div class="card" style="margin-bottom: 0;">
                        <span
                            style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase;">Last
                            Scan Run</span>
                        <h3 id="last-scan-stat" style="font-size: 2rem; margin: 10px 0 0 0;">Never</h3>
                    </div>
                    <div class="card" style="margin-bottom: 0;">
                        <span
                            style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase;">Health
                            Score</span>
                        <h3 style="font-size: 2rem; margin: 10px 0 0 0; color: var(--primary);">Optimal</h3>
                    </div>
                </div>

                <div class="grid-main" style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px;">
                    <div class="card">
                        <div class="card-title">
                            <span>Recent Scans</span>
                            <a href="#" class="btn btn-outline btn-small" style="font-size: 0.8rem;">View All</a>
                        </div>
                        <div id="history-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">Quick Actions</div>
                        <button class="btn btn-primary" style="width: 100%; margin-bottom: 12px;"
                            onclick="document.querySelector('[data-view=wizard]').click()">
                            <i class="fas fa-plus"></i> New Scan
                        </button>
                        <button class="btn btn-outline" style="width: 100%;"
                            onclick="document.querySelector('[data-view=schedules]').click()">
                            <i class="fas fa-calendar"></i> Manage Schedules
                        </button>
                    </div>
                </div>
            </section>

            <!-- VIEW: WIZARD -->
            <section id="wizard-view" class="view-section">
                <header class="view-header">
                    <h1>New Scan</h1>
                    <p>Configure and run a deduplication analysis.</p>
                </header>

                <div class="card">
                    <!-- Progress Steps -->
                    <div class="steps-container">
                        <div class="step active" data-step="1">
                            <div class="step-circle">1</div>
                            <span class="step-label">Scope</span>
                        </div>
                        <div class="step" data-step="2">
                            <div class="step-circle">2</div>
                            <span class="step-label">Strategy</span>
                        </div>
                        <div class="step" data-step="3">
                            <div class="step-circle">3</div>
                            <span class="step-label">Analysis</span>
                        </div>
                        <div class="step" data-step="4">
                            <div class="step-circle">4</div>
                            <span class="step-label">Review</span>
                        </div>
                    </div>

                    <!-- STEP 1: SCOPE -->
                    <div id="step-1-content" class="step-content active">
                        <h3>Where should we look?</h3>
                        <p style="color: var(--text-muted); margin-bottom: 24px;">Add the directory paths you want to
                            scan for duplicate files.</p>

                        <div id="wizard-paths-container">
                            <div class="path-row">
                                <input type="text" placeholder="/path/to/media" class="wizard-path-input">
                                <button class="btn btn-danger btn-icon" disabled><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        <button class="btn btn-outline btn-small" id="wizard-add-path-btn" style="margin-top: 10px;">
                            <i class="fas fa-plus"></i> Add Another Path
                        </button>

                        <div
                            style="margin-top: 40px; border-top: 1px solid var(--border); padding-top: 20px; display: flex; justify-content: flex-end;">
                            <button class="btn btn-primary" id="wizard-next-1">Next: Choose Strategy <i
                                    class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <!-- STEP 2: STRATEGY -->
                    <div id="step-2-content" class="step-content" style="display:none;">
                        <h3>Choose your strategy</h3>
                        <p style="color: var(--text-muted); margin-bottom: 24px;">Define how you want to handle
                            duplicate files when found.</p>

                        <div class="strategy-grid">
                            <div class="strategy-card selected" data-strategy="report">
                                <i class="fas fa-file-alt"></i>
                                <h4>Report Only</h4>
                                <p>Safest. Analyzes files and provides a report without making changes.</p>
                            </div>
                            <div class="strategy-card" data-strategy="hard">
                                <i class="fas fa-link"></i>
                                <h4>Hardlink</h4>
                                <p>Replaces duplicates with hardlinks. Saves space immediately.</p>
                            </div>
                            <div class="strategy-card" data-strategy="delete">
                                <i class="fas fa-trash-alt"></i>
                                <h4>Delete</h4>
                                <p>Deletes duplicate files. Use with extreme caution.</p>
                            </div>
                        </div>

                        <div style="margin-top: 30px;">
                            <button class="btn btn-outline" id="wizard-toggle-advanced" style="font-size: 0.85rem;">
                                <i class="fas fa-sliders-h"></i> Advanced Filters
                            </button>

                            <div id="wizard-advanced-filters"
                                style="display:none; margin-top: 20px; padding: 20px; background: var(--bg-main); border-radius: var(--border-radius);">
                                <div class="form-group">
                                    <label>Minimum File Size</label>
                                    <div style="display:flex; gap:10px;">
                                        <input type="number" id="wizard-min-size" value="1" style="flex:1;">
                                        <select id="wizard-size-unit" style="width: 100px;">
                                            <option value="MB">MB</option>
                                            <option value="GB">GB</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Exclude Patterns (comma separated)</label>
                                    <input type="text" id="wizard-ignore-dirs"
                                        placeholder="e.g. .git, tmp, node_modules">
                                </div>
                            </div>
                        </div>

                        <div
                            style="margin-top: 40px; border-top: 1px solid var(--border); padding-top: 20px; display: flex; justify-content: space-between;">
                            <button class="btn btn-outline" id="wizard-prev-2"><i class="fas fa-arrow-left"></i>
                                Back</button>
                            <button class="btn btn-primary" id="wizard-start-btn">Start Analysis <i
                                    class="fas fa-rocket"></i></button>
                        </div>
                    </div>

                    <!-- STEP 3: ANALYSIS -->
                    <div id="step-3-content" class="step-content" style="display:none; text-align: center;">
                        <h3>Performing Analysis...</h3>
                        <p style="color: var(--text-muted); margin-bottom: 40px;">Please wait while we scan and hash
                            your files.</p>

                        <div class="gauge-container">
                            <svg class="gauge-svg" viewBox="0 0 100 100">
                                <circle class="gauge-bg" cx="50" cy="50" r="45"></circle>
                                <circle id="wizard-gauge-fill" class="gauge-fill" cx="50" cy="50" r="45"
                                    stroke-dasharray="0 283"></circle>
                            </svg>
                            <div class="gauge-text">
                                <div id="wizard-progress-pct" class="gauge-pct">0%</div>
                                <div id="wizard-phase-label" class="gauge-label">Initializing</div>
                            </div>
                        </div>

                        <div id="wizard-stats" style="margin-top: 30px; font-weight: 500;">
                            <span id="wizard-processed-count">0</span> / <span id="wizard-total-count">0</span> files
                        </div>

                        <!-- Micro Progress (Live File Hashing) -->
                        <div id="wizard-micro-container"
                            style="margin-top: 20px; font-size: 0.85rem; color: var(--text-muted); text-align: left; max-width: 400px; margin-left: auto; margin-right: auto;">
                            <ul id="wizard-micro-list"
                                style="list-style: none; padding: 0; margin: 0; border-top: 1px solid var(--border); padding-top: 10px;">
                                <!-- Populated by JS -->
                            </ul>
                        </div>

                        <div style="margin-top: 40px; display: flex; justify-content: center; gap: 12px;">
                            <button class="btn btn-outline" id="wizard-pause-btn"><i class="fas fa-pause"></i>
                                Pause</button>
                            <button class="btn btn-danger" id="wizard-cancel-btn"><i class="fas fa-times"></i>
                                Cancel</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- VIEW: RESULTS -->
            <section id="results-view" class="view-section">
                <!-- Populated by results.js -->
            </section>

            <!-- VIEW: SCHEDULES -->
            <section id="schedules-view" class="view-section">
                <!-- Populated by schedules.js -->
            </section>

            <!-- VIEW: SETTINGS -->
            <section id="settings-view" class="view-section">
                <header class="view-header">
                    <h1>Settings</h1>
                    <p>Configure global application behavior.</p>
                </header>
                <div class="card">
                    <div class="form-group">
                        <label>Report Storage</label>
                        <p style="font-size: 0.85rem; color:var(--text-muted);">Reports are currently saved to
                            <code>/scan_history</code>.
                        </p>
                    </div>
                    <div class="form-group">
                        <label>Application Version</label>
                        <p>Hardlink Manager v2.0 (Reimagined)</p>
                    </div>
                    <button class="btn btn-danger" id="purge-cache-btn">
                        <i class="fas fa-trash"></i> Purge All cached results
                    </button>
                </div>
            </section>
        </main>
    </div>
</body>

</html>